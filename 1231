[general]
# > 用于节点延迟测试
#server_check_url=http://cp.cloudflare.com/generate_204
#server_check_url= http://www.qualcomm.cn/generate_204
server_check_url=http://captive.apple.com/generate_204
#server_check_url =http://www.google.com/generate_204
# > 服务器测试超时时间 (毫秒)
server_check_timeout = 3000
udp_drop_list = 53, QUIC
excluded_routes = 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, 100.64.0.0/10
dns_exclusion_list = *.lan, *.local, cable.auth.com, *.msftconnecttest.com, *.msftncsi.com, network-test.debian.org, detectportal.firefox.com, *.srv.nintendo.net, *.stun.playstation.net, *.xboxlive.com, *.logon.battle.net, pool.ntp.org, captive.apple.com, *.miwifi.com
dns_reject_domain_behavior = loopback

[dns]
no-system
no-ipv6
server=223.6.6.6
server=223.5.5.5
address=/s.lifengchun.top/74.48.129.174
address=/c.lifengchun.top/74.48.59.37

[policy]
static=China, direct, img-url=https://raw.githubusercontent.com/fhf1231/filterurl/main/China.png
static=AppleTV, direct, img-url=https://raw.githubusercontent.com/fhf1231/filterurl/main/Apple.png
static=Global, proxy, img-url=https://raw.githubusercontent.com/fhf1231/filterurl/main/Global.png

[server_remote]

[filter_remote]
# FILTER_REGION, tag=CN, force-policy=direct, inserted-resource=true, enabled=true
# FILTER_LAN, tag=LAN, force-policy=direct, inserted-resource=true, enabled=true
https://raw.githubusercontent.com/fhf1231/filterurl/main/mainland.list, tag=China, force-policy=China, opt-parser=false, enabled=true
https://raw.githubusercontent.com/fhf1231/filterurl/main/AppleTV.list, tag=AppleTV, force-policy=AppleTV, opt-parser=false, enabled=true
https://raw.githubusercontent.com/fhf1231/filterurl/main/overseas.list, tag=Global, force-policy=Global, opt-parser=false, enabled=true

[rewrite_remote]

[server_local]
vless=s.lifengchun.top:443, method=none, password=03b8e25e-16ea-4bc0-95fe-b8fd10bfcb73, obfs=wss, obfs-host=s.lifengchun.top, obfs-uri=/apps/files_sharing/public, tls-verification=true, fast-open=false, udp-relay=false, tag=rvlws
vmess=s.lifengchun.top:443, method=chacha20-ietf-poly1305, password=789324c6-4d3f-4ff0-833c-3193b81108ef, obfs=wss, obfs-uri=/ocs/v2.php/notifications/ws, tls-verification=true, fast-open=false, udp-relay=false, tag=rvm
trojan=74.48.129.174:443, password=aZ9#pLqV2!sRk6@w, obfs=wss, obfs-host=s.lifengchun.top, obfs-uri=/remote.php/dav/files/minicloud, udp-relay=false, tls-verification=true, tag=rtr
vmess=c.lifengchun.top:443, method=chacha20-ietf-poly1305, password=0986131e-ba14-4ef5-8794-c2e3b1ade4c9, obfs=wss, obfs-uri=/remote.php/dav/files/admin/Videos/4K_Stream_Cache, tls-verification=true, fast-open=false, udp-relay=false, tag=cvm
trojan=74.48.59.37:443, password=xV8%nJ3&cW5@eP9b, obfs=wss, obfs-host=c.lifengchun.top, obfs-uri=/remote.php/dav/files/admin/Photos/CameraUpload, udp-relay=false, tls-verification=true, tag=ctr
trojan=c.lifengchun.top:443, password=xV8%nJ3&cW5@eP9b, obfs=wss, obfs-host=c.lifengchun.top, obfs-uri=/remote.php/dav/files/admin/Photos/CameraUpload, udp-relay=false, tls-verification=true, tag=ctry
vless=c.lifengchun.top:443, method=none, password=35fd9743-2bdd-4428-a310-11a337496c81, obfs=wss, obfs-host=c.lifengchun.top, obfs-uri=/apps/files_sharing/public, tls-verification=true, fast-open=false, udp-relay=false, tag=cvlws

[filter_local]
host-suffix, local, direct
ip-cidr, 192.168.0.0/16, direct
ip-cidr, 10.0.0.0/8, direct
ip-cidr, 172.16.0.0/12, direct
ip-cidr, 127.0.0.0/8, direct
ip-cidr, 100.64.0.0/10, direct
ip-cidr, 224.0.0.0/4, direct

HOST, mlvbdc.live.tlivesource.com, direct
HOST, pull-m1.wxlivecdn.com, direct

host-suffix, openai.com, proxy
host-suffix, devvit.net, proxy  
host-suffix, appsflyer.com, proxy
host-suffix, branch.io, proxy
host-suffix, sng.link, proxy
host-suffix, revenuecat.com, proxy
host-suffix, sentry.io, proxy
host-suffix, chronosphere.io, proxy
host-suffix, featureassets.org, proxy
host-suffix, prodregistryv2.org, proxy
host-suffix, slivor.com, proxy
host-suffix, nirvarna.com, proxy
host-suffix, simperium.com, proxy
host-suffix, giphy.com, proxy
host-suffix, thesitebase.net, proxy
host-suffix, quantumult.app, proxy
host-suffix, impression.link, proxy
host-suffix, datadoghq.com, proxy
host-suffix, logbase.org, proxy
host-suffix, datadoghq.com, proxy
# === 开发与性能监控 (必须代理) ===
# 理由：Datadog 的数据接收端位于美国 AWS。虽然 DNS 解析快，但直连上传数据极慢且不稳定，容易导致 App 后台耗电。
host-suffix, datadoghq.com, proxy

host-suffix, kochava.com, reject
host-suffix, scorecardresearch.com, reject
# === 广告与数据追踪 (建议拒绝) ===
# 理由：VideoAmp 是广告测量与数据分析平台，属于纯粹的追踪器。拦截它能保护隐私并加速视频加载。
host-suffix, videoamp.com, reject

# === Apple TV 界面与鉴权 (必须走代理) ===
HOST-SUFFIX, tv.apple.com, proxy
HOST-SUFFIX, tv.applemusic.com, proxy
HOST-SUFFIX, apple.news, proxy
HOST, uts-api.itunes.apple.com, proxy
HOST, play.itunes.apple.com, proxy
HOST, play-edge.itunes.apple.com, proxy
HOST, linear.tv.apple.com, proxy
HOST, sports.tv.apple.com, proxy
HOST, movies.apple.com, proxy
HOST, books.apple.com, proxy


# === Apple TV 视频流数据 (必须直连) ===
# 4K HDR 视频数据源，直连速度最快且省流量
HOST, hls.itunes.apple.com, direct
HOST, hls-amt.itunes.apple.com, direct
HOST, hls-svod.itunes.apple.com, direct
HOST, hls-vod.itunes.apple.com, direct
HOST-SUFFIX, hls.itunes.apple.com, direct

# === App Store 图片与下载 CDN (必须直连) ===
# 各种海报、图标、应用下载
HOST-SUFFIX, mzstatic.com, direct
HOST-SUFFIX, cdn-apple.com, direct
HOST-SUFFIX, aaplimg.com, direct
HOST-SUFFIX, apple-cloudkit.com, direct
HOST-SUFFIX, icloud-content.com, direct

# === 基础服务与 CDN (必须直连) ===
# 确保系统时间准确、推送及时收到
HOST-SUFFIX, akadns.net, direct
HOST, time.apple.com, direct
HOST, time.asia.apple.com, direct
HOST, time.euro.apple.com, direct
HOST, apple.com.akadns.net, direct
HOST, configuration-lb.ls-apple.com.akadns.net, direct
HOST, courier-push-apple.com.akadns.net, direct
HOST, push-apple.com.akadns.net, direct

host-suffix, ads.youtube.com, reject
host-suffix, doubleclick.net, reject
HOST-SUFFIX, app-measurement.com, REJECT
host-suffix, app-analytics-services.com, reject

# HOST-SUFFIX, stocks-data-service.apple.com, proxy
# HOST, token.safebrowsing.apple, proxy

# HOST-SUFFIX, googleapis.com, proxy
# HOST-SUFFIX, gstatic.com, proxy
# HOST-SUFFIX, s.youtube.com, proxy

# HOST-SUFFIX, mzstatic.com, direct
# HOST-SUFFIX, cdn-apple.com, direct

host-suffix, cn, direct
geoip, cn, direct

final, proxy

[rewrite_local]
https?:\/\/[\w-]+\.googlevideo\.com\/initplayback.*&oad url reject-200
^https:\/\/youtubei\.googleapis\.com\/youtubei\/v1\/(next|player|browse|search|get_watch|guide) url script-response-body https://raw.githubusercontent.com/Maasea/sgmodule/master/Script/Youtube/youtube.response.js?captionLang=off&lyricLang=off&blockUpload=true&blockImmersive=true&blockShorts=false&debug=false

[task_local]

[http_backend]

[mitm]
hostname = youtubei.googleapis.com, *.googlevideo.com
